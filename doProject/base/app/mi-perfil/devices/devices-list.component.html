<ion-header *ngIf="!embedded">

  <ion-toolbar *ngIf="isModal">
    <ion-buttons slot="start">
      <ion-button (click)="modal.dismiss()">
        <ion-icon slot="icon-only" name="close-circle"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{headerText}}</ion-title>
  </ion-toolbar>
  
  <ion-grid fixed>
    <ion-row>
      <ion-col>
        <ion-searchbar #searchbar [(ngModel)]="match" debounce="500" placeholder="{{'buttons.search' | translate}}..."></ion-searchbar>
      </ion-col>
      <ion-col size="auto">
        <ion-button (click)="selectRow('new')" slot="end" fill="clear" size="large">
        </ion-button>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-progress-bar *ngIf="loading" type="indeterminate"></ion-progress-bar>

</ion-header>
<ion-header *ngIf="embedded" class="ion-margin-top">

  <ion-item>
    <ion-label>{{'devices.devices_list' | translate}}:</ion-label>
  </ion-item>

</ion-header>
<ion-content autosize="ion-list" [scrollY]="!embedded">

  <ion-list>

    <ion-grid fixed>
      <ion-row>
        <ion-col size="12" *ngFor="let row of rows | filter:match:list.filter | orderBy:list.orderBy">
          
          <ion-item-sliding>
            <ion-item button (click)="selectRow(row)" [detail]="!isPickRowMode" [ngClass]="{ selected: isSelected(row)}">
              
              <ion-icon *ngIf="preloading !== row.idreg && row?.info?.operatingSystem" [name]="service.deviceIcon(row?.info?.operatingSystem)" slot="start"></ion-icon>
              <ion-spinner *ngIf="preloading === row.idreg" name="lines-small" slot="start"></ion-spinner>
              <ion-label class="ion-text-wrap">
                <ion-text><text-colorized [value]="row.description" [match]="match"></text-colorized></ion-text>
                <p>
                  <text-colorized [value]="row.lastLoginLong" [match]="match"></text-colorized>
                  <span *ngIf="filterProperty(row.lastLoginShortDate)"> (<text-colorized [value]="row.lastLoginShortDate" [match]="match"></text-colorized>)</span>
                </p>
                <p *ngIf="filterProperty(row.info.model)"><text-colorized [value]="row.info.model" [match]="match"></text-colorized></p>
                <p *ngIf="filterProperty(row.info.manufacturer)"><text-colorized [value]="row.info.manufacturer" [match]="match"></text-colorized></p>
              </ion-label>
              <ion-icon *ngIf="user.instant.device.idreg === row.idreg" name="log-in" color="primary" slot="end"></ion-icon>
              
              <ion-icon *ngIf="isSelected(row)" slot="end" name="checkmark"></ion-icon>
            </ion-item>

            <ion-item-options side="end">
              <ion-item-option (click)="cerrarSesion(row)" *ngIf="!!row.apiToken && !!row.apiExpiration" hasPermission="devices.multilogin" color="warning">
                <ion-icon slot="icon-only" name="log-out"></ion-icon>
              </ion-item-option>
              <ion-item-option (click)="deleteRow(row)" color="danger">
                <ion-icon slot="icon-only" name="trash"></ion-icon>
              </ion-item-option>
            </ion-item-options>
          </ion-item-sliding> 

        </ion-col>
      </ion-row>
    </ion-grid>

  </ion-list>


</ion-content>


