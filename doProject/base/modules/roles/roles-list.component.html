<ion-header>

  <ion-toolbar *ngIf="isModal">
    <ion-buttons slot="start">
      <ion-button (click)="modal.dismiss()">
        <ion-icon slot="icon-only" name="close-circle"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>{{headerText}}</ion-title>
  </ion-toolbar>
  
  <ion-grid fixed>
    <ion-row>
      <ion-col>
        <ion-searchbar #searchInput [(ngModel)]="search" debounce="500" placeholder="{{'buttons.search' | translate}}..."></ion-searchbar>
      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-grid fixed *ngIf="!!multiSelect && multiSelect.multi">
    <ion-row>
      <ion-col>

        <ion-toolbar class="marcar-todos">
          <ion-buttons *ngIf="!search">
            <ion-button (click)="toggleCheckAll(true)">
              <ion-icon name="checkmark-circle-outline" slot="start"></ion-icon> {{'Marcar todos' | translate}}
            </ion-button>
            <ion-button (click)="toggleCheckAll(false)">
              <ion-icon name="radio-button-off" slot="start"></ion-icon> {{'Desmarcar todos' | translate}}
            </ion-button>
          </ion-buttons>
          <ion-buttons *ngIf="!!search">
            <ion-button (click)="toggleCheckFiltered(true)">
              <ion-icon name="checkmark-circle-outline" slot="start"></ion-icon> {{'Marcar filtrados' | translate}}
            </ion-button>
            <ion-button (click)="toggleCheckFiltered(false)">
              <ion-icon name="radio-button-off" slot="start"></ion-icon> {{'Desmarcar filtrados' | translate}}
            </ion-button>
          </ion-buttons>
        </ion-toolbar>

      </ion-col>
    </ion-row>
  </ion-grid>

  <ion-progress-bar *ngIf="loading" type="indeterminate"></ion-progress-bar>

</ion-header>
<ion-content>

  <ion-list class="disable-user-behavior" [ngClass]="{ 'disable-pointer-events': multiSelect, 'list-left-editing': multiSelect }">
    <ion-grid fixed>
      <ion-row>
        <ion-col size="12" *ngFor="let row of rows | filter:search:list.filter | orderBy:list.orderBy">

          <ion-item-sliding>
            <ion-item button (click)="selectRow(row)" [detail]="!isPickRowMode && !row.abstract" [ngClass]="{ selected: isSelected(row)}" class="item-color">

              <ion-icon *ngIf="preloading !== row.idreg" name="person-circle" slot="start"></ion-icon>
              <ion-spinner *ngIf="preloading === row.idreg" name="lines-small" slot="start"></ion-spinner>
              <ion-label class="ion-text-wrap">
                <text-colorized [value]="row.name" [search]="search"></text-colorized>
                <p *ngIf="row.abstract">{{'role.principal' | translate}}</p>
                <p *ngIf="row.idParent"><text-colorized [value]="row.parents" [search]="search"></text-colorized></p>
              </ion-label>
              <ion-icon *ngIf="row.abstract" name="lock-closed" slot="end" size="small"></ion-icon>

              <ion-icon *ngIf="isSelected(row)" slot="end" name="checkmark"></ion-icon>
            </ion-item>

            <ion-item-options side="start">
              <ion-item-option (click)="newRow(row.idreg)" color="success">
                <ion-icon slot="icon-only" name="person-add"></ion-icon>
              </ion-item-option>
            </ion-item-options>
            <ion-item-options side="end">
              <ion-item-option (click)="deleteRow(row)" color="danger" *ngIf="!row.abstract">
                <ion-icon slot="icon-only" name="trash"></ion-icon>
              </ion-item-option>
            </ion-item-options>
          </ion-item-sliding> 

        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-list>

  <ion-infinite-scroll (ionInfinite)="refresh($event)" threshold="100px">
    <ion-infinite-scroll-content loadingSpinner="circles" loadingText="{{loadingText}}"></ion-infinite-scroll-content>
  </ion-infinite-scroll>

</ion-content>
<!-- <ion-footer *ngIf="multiSelect">

  <ion-grid fixed>
    <ion-row *ngIf="!!multiSelect && multiSelect.multi">
      <ion-col>
        <p class="ion-text-center">{{checkedChanged | async}} servicios seleccionados</p>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col>
        <ion-button (click)="executeMultiSelectMode()" [disabled]="!(checkedChanged | async)" color="primary" expand="block">
          <ion-icon slot="start" [name]="multiSelect?.icon"></ion-icon>
          {{'servicios.' + multiSelect?.name | translate}}
        </ion-button>
      </ion-col>
      <ion-col>
        <ion-button (click)="closeMultiSelectMode()" color="secondary" expand="block">
          <ion-icon slot="start" name="close"></ion-icon> {{'buttons.cancel' | translate}}
        </ion-button>
      </ion-col>
    </ion-row>
  </ion-grid>

</ion-footer>
<ion-footer *ngIf="!isPickRowMode" text-center padding-start padding-end>

  <ion-grid fixed>
    <ion-row>
      <ion-col>

        <ion-button (click)="selectRow('new')" color="primary" expand="block">
          <ion-icon slot="start" name="add"></ion-icon>
          {{addNewText}}
        </ion-button>

      </ion-col>
    </ion-row>
  </ion-grid>

</ion-footer> -->
